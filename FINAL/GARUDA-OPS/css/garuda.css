:root{
  --g:#00f5a0;--b:#00d4ff;--gd:#ffd700;--o:#ff8c00;--r:#ff4466;--pu:#a855f7;
  --bg:#04060f;--pan:#07091a;--bdr:#1a2540;--tx:#6080a0;--tx2:#80a0c0;
}
*{margin:0;padding:0;box-sizing:border-box}
body{background:var(--bg);color:var(--tx2);font-family:"Share Tech Mono",monospace;height:100vh;overflow:hidden;display:flex;flex-direction:column}
body::after{content:"";position:fixed;inset:0;pointer-events:none;z-index:9999;background:repeating-linear-gradient(0deg,transparent,transparent 3px,rgba(0,212,255,.004) 3px,rgba(0,212,255,.004) 4px)}

@keyframes shimmer{from{background-position:0%}to{background-position:200%}}
@keyframes dpulse{0%,100%{opacity:1;transform:scale(1)}50%{opacity:.15;transform:scale(.4)}}
@keyframes glowIn{from{opacity:0;transform:translateX(12px)}to{opacity:1;transform:none}}
@keyframes fadeUp{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:none}}
@keyframes rtbPulse{0%,100%{border-color:var(--o);box-shadow:0 0 8px rgba(255,140,0,.2)}50%{border-color:rgba(255,140,0,.3);box-shadow:none}}
@keyframes homePulse{0%,100%{border-color:var(--pu);box-shadow:0 0 8px rgba(168,85,247,.2)}50%{border-color:rgba(168,85,247,.3);box-shadow:none}}
@keyframes rechargePulse{0%,100%{border-color:var(--b);box-shadow:0 0 8px rgba(0,212,255,.2)}50%{border-color:rgba(0,212,255,.3);box-shadow:none}}

/* ── HEADER ── */
header{padding:8px 18px;border-bottom:1px solid var(--bdr);display:flex;align-items:center;justify-content:space-between;background:linear-gradient(90deg,#020309,var(--pan));flex-shrink:0;z-index:50}
.logo{font-family:"Orbitron",sans-serif;font-weight:900;font-size:13px;letter-spacing:5px;background:linear-gradient(90deg,var(--g),var(--b),var(--gd));background-size:200%;-webkit-background-clip:text;-webkit-text-fill-color:transparent;animation:shimmer 5s linear infinite}
.hdr-r{display:flex;align-items:center;gap:10px;font-size:8px;letter-spacing:2px;color:var(--tx)}
.ldot{width:6px;height:6px;border-radius:50%;background:var(--g);box-shadow:0 0 7px var(--g);display:inline-block;animation:dpulse 1.4s infinite}
.hbtn{padding:4px 10px;background:transparent;border:1px solid var(--b);color:var(--b);font-family:"Share Tech Mono",monospace;font-size:8px;letter-spacing:1px;cursor:pointer;border-radius:2px;transition:all .2s}
.hbtn:hover{background:var(--b);color:var(--bg)}
.hbtn.active{background:rgba(255,68,102,.15);border-color:var(--r);color:var(--r)}

/* ── LAYOUT ── */
.layout{display:grid;grid-template-columns:195px 1fr 210px;flex:1;min-height:0}
.lp,.rp{padding:10px;display:flex;flex-direction:column;gap:10px;background:var(--pan);overflow-y:auto}
.lp{border-right:1px solid var(--bdr)}
.rp{border-left:1px solid var(--bdr)}
.lp::-webkit-scrollbar,.rp::-webkit-scrollbar{width:2px}
.lp::-webkit-scrollbar-thumb,.rp::-webkit-scrollbar-thumb{background:var(--bdr)}

.sec-title{font-family:"Orbitron",sans-serif;font-size:7px;letter-spacing:3px;color:var(--b);border-bottom:1px solid var(--bdr);padding-bottom:5px;margin-bottom:4px}
.kv{display:flex;justify-content:space-between;align-items:center;font-size:9px;padding:2px 0;color:var(--tx)}
.val{font-size:11px;font-weight:bold}
.vg{color:var(--g);text-shadow:0 0 8px rgba(0,245,160,.35)}
.vb{color:var(--b);text-shadow:0 0 8px rgba(0,212,255,.35)}
.vgd{color:var(--gd);text-shadow:0 0 8px rgba(255,215,0,.35)}
.vo{color:var(--o)}
.vr{color:var(--r)}
.vpu{color:var(--pu)}

/* ── DRONE CARDS ── */
.dcard{border:1px solid var(--bdr);border-radius:3px;padding:8px;transition:border-color .4s,box-shadow .4s}
.dcard.rtb{animation:rtbPulse 1s infinite}
.dcard.returning{animation:homePulse 1s infinite}
.dcard.recharging{animation:rechargePulse 1.2s infinite}
.dcard.done{opacity:.3;border-color:var(--bdr)!important}
.dcard-hd{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}
.dname{font-family:"Orbitron",sans-serif;font-size:8px;font-weight:700;letter-spacing:2px}
.badge{font-size:7px;padding:2px 6px;border:1px solid;border-radius:2px;letter-spacing:1px}
.battbar{width:100%;height:7px;background:#08102a;border:1px solid var(--bdr);border-radius:2px;overflow:hidden;margin-top:3px}
.battfill{height:100%;border-radius:2px;transition:width .5s,background .6s,box-shadow .6s}

/* ── BUTTONS ── */
.btn{padding:7px 10px;background:transparent;border:1px solid;font-family:"Share Tech Mono",monospace;font-size:9px;letter-spacing:2px;cursor:pointer;width:100%;position:relative;overflow:hidden;border-radius:2px;transition:letter-spacing .25s,box-shadow .25s}
.btn::before{content:"";position:absolute;inset:0;transform:translateX(-101%);transition:transform .25s;z-index:0}
.btn:hover::before{transform:translateX(0)}
.btn:hover{letter-spacing:3px}
.btn span{position:relative;z-index:1}
.bg{border-color:var(--g);color:var(--g)}.bg::before{background:var(--g)}.bg:hover{color:var(--bg)!important;box-shadow:0 0 20px rgba(0,245,160,.2)}
.bb{border-color:var(--b);color:var(--b)}.bb::before{background:var(--b)}.bb:hover{color:var(--bg)!important;box-shadow:0 0 20px rgba(0,212,255,.2)}
.bgd{border-color:var(--gd);color:var(--gd)}.bgd::before{background:var(--gd)}.bgd:hover{color:var(--bg)!important}
.bo{border-color:var(--o);color:var(--o)}.bo::before{background:var(--o)}.bo:hover{color:var(--bg)!important}
.br{border-color:var(--r);color:var(--r)}.br::before{background:var(--r)}.br:hover{color:var(--bg)!important}
.bpu{border-color:var(--pu);color:var(--pu)}.bpu::before{background:var(--pu)}.bpu:hover{color:var(--bg)!important}
.btn:disabled{opacity:.2;cursor:not-allowed;pointer-events:none}
.btn-row{display:flex;gap:5px}.btn-row .btn{flex:1}

input[type=range]{width:100%;-webkit-appearance:none;height:2px;background:var(--bdr);outline:none;margin-top:5px;cursor:pointer}
input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:11px;height:11px;border-radius:50%;background:var(--b);box-shadow:0 0 6px var(--b)}

.cnt-row{display:flex;gap:4px}
.cnt-btn{flex:1;padding:5px 0;background:transparent;border:1px solid var(--bdr);color:var(--tx);font-family:"Share Tech Mono",monospace;font-size:11px;cursor:pointer;border-radius:2px;transition:all .2s}
.cnt-btn.on{background:linear-gradient(135deg,var(--b),var(--pu));border-color:var(--b);color:#fff;box-shadow:0 0 12px rgba(0,212,255,.3)}

/* ── CENTER MAP AREA ── */
.center{display:flex;flex-direction:column;align-items:center;justify-content:center;position:relative;background:radial-gradient(ellipse at 50% 38%,#080f20,var(--bg))}
.map-wrap{position:relative}
.map-corner{position:absolute;width:12px;height:12px;pointer-events:none;z-index:5}
.mc-tl{top:-1px;left:-1px;border-top:2px solid var(--b);border-left:2px solid var(--b)}
.mc-tr{top:-1px;right:-1px;border-top:2px solid var(--b);border-right:2px solid var(--b)}
.mc-bl{bottom:-1px;left:-1px;border-bottom:2px solid var(--gd);border-left:2px solid var(--gd)}
.mc-br{bottom:-1px;right:-1px;border-bottom:2px solid var(--gd);border-right:2px solid var(--gd)}
#gc{display:block;border:1px solid var(--bdr)}

.top-tag{position:absolute;top:-22px;left:50%;transform:translateX(-50%);font-family:"Orbitron",sans-serif;font-size:7px;letter-spacing:3px;color:var(--tx);white-space:nowrap;pointer-events:none}
.cbar{font-size:8px;letter-spacing:1px;color:var(--tx);margin-top:6px;text-align:center;min-height:15px}

/* ── HINT ── */
.hintbox{position:absolute;top:28px;left:50%;transform:translateX(-50%);pointer-events:none;z-index:50}
.hint{font-family:"Orbitron",sans-serif;font-size:8px;letter-spacing:2px;padding:4px 14px;white-space:nowrap;border:1px solid;border-radius:2px;animation:fadeUp .25s ease}
.hint-obs{background:rgba(255,140,0,.12);border-color:var(--o);color:var(--o)}
.hint-al{background:rgba(255,68,102,.12);border-color:var(--r);color:var(--r)}
.hint-inf{background:rgba(0,212,255,.08);border-color:var(--b);color:var(--b)}
.hint-mem{background:rgba(168,85,247,.08);border-color:var(--pu);color:var(--pu)}
.hint-ok{background:rgba(0,245,160,.08);border-color:var(--g);color:var(--g)}

/* ── EDITOR BAR ── */
.edbar{position:absolute;bottom:28px;left:50%;transform:translateX(-50%);display:none;gap:6px;align-items:center;background:rgba(7,9,26,.96);border:1px solid var(--bdr);padding:6px 12px;z-index:20;border-radius:3px}
.tbtn{padding:4px 10px;background:transparent;border:1px solid;font-family:"Share Tech Mono",monospace;font-size:8px;cursor:pointer;border-radius:2px;transition:all .2s}
.t-obs{border-color:var(--r);color:var(--r)}.t-obs.on{background:var(--r);color:#000}
.t-nfz{border-color:var(--o);color:var(--o)}.t-nfz.on{background:var(--o);color:#000}
.t-era{border-color:var(--b);color:var(--b)}.t-era.on{background:var(--b);color:#000}
.t-clr{border-color:var(--r);color:var(--r)}

/* ── DONE OVERLAY ── */
.done-ov{position:absolute;inset:0;background:rgba(4,6,15,.95);display:none;flex-direction:column;align-items:center;justify-content:center;gap:14px;z-index:200;overflow-y:auto;padding:20px 0}
.done-ov.show{display:flex}
.done-title{font-family:"Orbitron",sans-serif;font-size:18px;font-weight:900;letter-spacing:7px;background:linear-gradient(90deg,var(--g),var(--b),var(--gd));background-size:200%;-webkit-background-clip:text;-webkit-text-fill-color:transparent;animation:shimmer 2s linear infinite}
.done-grid{display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px 22px;font-size:10px;color:var(--tx)}
.done-grid b{color:var(--g)}
.done-note{font-size:9px;color:var(--pu);letter-spacing:1px;text-align:center;max-width:440px;line-height:1.6}
.done-btns{display:flex;gap:10px}.done-btns .btn{min-width:120px}
/* Learning curve */
.lc-section{width:360px;display:none}
.lc-title{font-family:"Orbitron",sans-serif;font-size:7px;letter-spacing:3px;color:var(--b);margin-bottom:6px}
.lc-row{display:flex;align-items:center;gap:6px;margin-bottom:3px;font-size:8px;color:var(--tx)}
.lc-bar{flex:1;height:5px;background:#08102a;border-radius:3px;overflow:hidden}
.lc-fill{height:100%;border-radius:3px;transition:width 1s ease}
@keyframes learnPulse{0%{box-shadow:0 0 0 0 rgba(0,245,160,.5)}100%{box-shadow:0 0 0 8px rgba(0,245,160,0)}}

/* ── MISSION HISTORY ── */
.mhrow{display:flex;align-items:center;gap:5px;font-size:8px;color:var(--tx)}
.mhtrack{flex:1;height:5px;background:#08102a;border-radius:2px;overflow:hidden}
.mhfill{height:100%;border-radius:2px;transition:width 1.2s ease}

/* ── EVENT LOG ── */
.elog{flex:1;min-height:0;overflow-y:auto;display:flex;flex-direction:column;gap:2px}
.elog::-webkit-scrollbar{width:2px}
.elog::-webkit-scrollbar-thumb{background:var(--bdr)}
.ei{font-size:8px;padding:2px 6px;border-left:2px solid;line-height:1.5;animation:glowIn .2s ease}
.ei.al{border-color:var(--r);color:rgba(255,68,102,.8)}
.ei.inf{border-color:var(--b);color:rgba(0,212,255,.7)}
.ei.mem{border-color:var(--pu);color:rgba(168,85,247,.8)}
.ei.ok{border-color:var(--g);color:rgba(0,245,160,.8)}
.ei.w{border-color:var(--gd);color:rgba(255,215,0,.8)}

/* ── LEGEND ── */
.legend-item{display:flex;align-items:center;gap:7px;font-size:8px;color:var(--tx);line-height:1.4}
.legend-dot{width:11px;height:11px;border-radius:2px;flex-shrink:0}

/* ── COORD MODAL ── */
.modal-bg{position:fixed;inset:0;background:rgba(0,0,0,.88);z-index:500;display:none;align-items:center;justify-content:center}
.modal-bg.open{display:flex}
.modal{background:var(--pan);border:1px solid rgba(0,212,255,.28);border-radius:5px;padding:28px 32px;min-width:460px;position:relative;box-shadow:0 0 80px rgba(0,212,255,.1)}
.modal::before{content:"";position:absolute;top:-1px;left:-1px;width:14px;height:14px;border-top:2px solid var(--b);border-left:2px solid var(--b)}
.modal::after{content:"";position:absolute;bottom:-1px;right:-1px;width:14px;height:14px;border-bottom:2px solid var(--gd);border-right:2px solid var(--gd)}
.modal-t{font-family:"Orbitron",sans-serif;font-size:11px;letter-spacing:4px;background:linear-gradient(90deg,var(--b),var(--g));-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:3px}
.modal-s{font-size:8px;letter-spacing:2px;color:var(--tx);margin-bottom:18px}
.mgrid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:14px}
.mfield label{font-size:8px;letter-spacing:2px;color:var(--tx);display:block;margin-bottom:5px}
.mfield input{width:100%;background:#020408;border:1px solid var(--bdr);color:var(--b);font-family:"Share Tech Mono",monospace;font-size:13px;padding:7px 9px;outline:none;border-radius:2px;transition:border-color .2s}
.mfield input:focus{border-color:var(--b)}
.preset-row{display:flex;gap:5px;flex-wrap:wrap;margin-bottom:12px}
.preset-btn{padding:3px 9px;background:transparent;border:1px solid var(--bdr);color:var(--tx2);font-family:"Share Tech Mono",monospace;font-size:8px;cursor:pointer;border-radius:2px;transition:all .2s}
.preset-btn:hover{border-color:var(--b);color:var(--b)}
.preset-btn.danger{border-color:var(--r);color:var(--r)}
.preset-btn.danger:hover{background:var(--r);color:#fff}
.preview-box{background:#020408;border:1px solid var(--bdr);padding:10px 12px;margin-bottom:14px;font-size:9px;color:var(--tx);line-height:2;border-radius:2px}
.preview-box .pk{color:var(--b)}
.mbtns{display:flex;gap:8px}.mbtns .btn{flex:1;padding:9px}